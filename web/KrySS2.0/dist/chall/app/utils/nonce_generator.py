from Crypto.Util.number import *

BITS = 384

# hex(state >> (BITS - 64))[2:]


def get_nonce(state=None):
    a = 33512999749417623590472805508750190083700063232957133886465147715290688313218350272866001118397937483369479135959869
    b = 38182801665815358509351762164752706491302718093964593212937534404130947785904732184486617725553411469308936847180409
    m = 33828807364750862843652002141728143388944991056503758470531642562008967710932811368794217002908614490423558622239481

    if state == None:
        state = getPrime(BITS - 1)
    else:
        state = (a*state + b) % m
    return state
